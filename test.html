<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>График функции</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.min.js"></script>
</head>
<body>

<h2>Введите функцию:</h2>
<input type="text" id="functionInput" placeholder="Пример: x^2 + 2*x + 1">
<button onclick="drawGraph()">Нарисовать график</button>

<div id="graph"></div>
<script type="importmap">
  {
    "imports": {
      "@google/generative-ai": "https://esm.run/@google/generative-ai"
    }
  }
</script>
<script type="module">
// function drawGraph() {
//   // Получаем значение функции из поля ввода
//   var inputFunction = document.getElementById("functionInput").value;

//   // Создаем массив значений x от -10 до 10 с шагом 0.1
//   var xValues = [];
//   for (var x = -10; x <= 10; x += 0.1) {
//     xValues.push(x);
//   }

//   // Вычисляем значения y для каждого x с использованием math.js
//   var yValues = xValues.map(function(x) {
//     try {
//       var scope = { x: x };
//       var y = math.evaluate(inputFunction, scope);
//       return y;
//     } catch (error) {
//       return NaN; // Если произошла ошибка при вычислении значения, помечаем как NaN
//     }
//   });

//   // Очищаем предыдущий график (если он есть)
//   var graphDiv = document.getElementById("graph");
//   Plotly.purge(graphDiv);

//   // Рисуем новый график
//   Plotly.newPlot(graphDiv, [{
//     x: xValues,
//     y: yValues,
//     type: 'scatter',
//     mode: 'lines',
//     name: inputFunction
//   }]);
// }
// node --version # Should be >= 18
// npm install @google/generative-ai
const {
  GoogleGenerativeAI,
  HarmCategory,
  HarmBlockThreshold,
} = require("@google/generative-ai");

const MODEL_NAME = "gemini-pro";
const API_KEY = "AIzaSyBt_lAZTgr_sGBpILMRvyMh8jfucxQnqtw";

async function runChat() {
  const genAI = new GoogleGenerativeAI(API_KEY);
  const model = genAI.getGenerativeModel({ model: MODEL_NAME });

  const generationConfig = {
    temperature: 0.9,
    topK: 1,
    topP: 1,
    maxOutputTokens: 2048,
  };

  const safetySettings = [
    {
      category: HarmCategory.HARM_CATEGORY_HARASSMENT,
      threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
    },
    {
      category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,
      threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
    },
    {
      category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,
      threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
    },
    {
      category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,
      threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,
    },
  ];

  const chat = model.startChat({
    generationConfig,
    safetySettings,
    history: [
      {
        role: "user",
        parts: [{ text: "привет"}],
      },
      {
        role: "model",
        parts: [{ text: "Привет, я чат-бот Genery, чем могу помочь?"}],
      }
    ],
  });

  const result = await chat.sendMessage("привет");
  const response = result.response;
  console.log(response.text());
}

runChat();
</script>

</body>
</html>
